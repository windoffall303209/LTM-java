<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ƒêƒÉng K√Ω - Auction System</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .register-container {
        width: 100%;
        max-width: 550px;
      }
      .register-card {
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <div class="register-container">
      <div class="card register-card">
        <div class="card-body p-5">
          <div class="text-center mb-4">
            <h2 class="fw-bold">üî® ƒêƒÉng K√Ω T√†i Kho·∫£n</h2>
            <p class="text-muted">T·∫°o t√†i kho·∫£n ƒë·ªÉ b·∫Øt ƒë·∫ßu ƒë·∫•u gi√°</p>
          </div>

          <!-- Alert Container -->
          <div id="alertContainer"></div>

          <!-- Register Form -->
          <form id="registerForm">
            <div class="mb-3">
              <label for="username" class="form-label">Username *</label>
              <input
                type="text"
                class="form-control"
                id="username"
                required
                minlength="3"
                maxlength="50"
                placeholder="Nh·∫≠p username (3-50 k√Ω t·ª±)"
              />
              <div class="invalid-feedback">
                Username ph·∫£i t·ª´ 3-50 k√Ω t·ª±
              </div>
            </div>

            <div class="mb-3">
              <label for="email" class="form-label">Email *</label>
              <input
                type="email"
                class="form-control"
                id="email"
                required
                placeholder="Nh·∫≠p email"
              />
              <div class="invalid-feedback">Email kh√¥ng h·ª£p l·ªá</div>
            </div>

            <div class="mb-3">
              <label for="fullName" class="form-label">H·ªç v√† T√™n</label>
              <input
                type="text"
                class="form-control"
                id="fullName"
                placeholder="Nh·∫≠p h·ªç v√† t√™n (t√πy ch·ªçn)"
              />
            </div>

            <div class="mb-3">
              <label for="password" class="form-label">Password *</label>
              <input
                type="password"
                class="form-control"
                id="password"
                required
                minlength="6"
                placeholder="Nh·∫≠p password (t·ªëi thi·ªÉu 6 k√Ω t·ª±)"
              />
              <div class="invalid-feedback">
                Password ph·∫£i √≠t nh·∫•t 6 k√Ω t·ª±
              </div>
            </div>

            <div class="mb-3">
              <label for="confirmPassword" class="form-label"
                >X√°c nh·∫≠n Password *</label
              >
              <input
                type="password"
                class="form-control"
                id="confirmPassword"
                required
                placeholder="Nh·∫≠p l·∫°i password"
              />
              <div class="invalid-feedback">Password kh√¥ng kh·ªõp</div>
            </div>

            <div class="alert alert-info small">
              <strong>L∆∞u √Ω:</strong> Sau khi ƒëƒÉng k√Ω, b·∫°n s·∫Ω nh·∫≠n
              10.000.000 VND ƒë·ªÉ ƒë·∫•u gi√°!
            </div>

            <button type="submit" class="btn btn-primary btn-lg w-100 mb-3">
              ƒêƒÉng k√Ω
            </button>

            <div class="text-center">
              <p class="mb-0">
                ƒê√£ c√≥ t√†i kho·∫£n?
                <a href="login.html" class="text-decoration-none fw-bold"
                  >ƒêƒÉng nh·∫≠p</a
                >
              </p>
              <a href="index.html" class="text-muted small">‚Üê Quay v·ªÅ trang ch·ªß</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/config.js"></script>
    <script>
      const alertContainer = document.getElementById('alertContainer');

      function showAlert(type, message) {
        alertContainer.innerHTML = `
          <div class="alert alert-${type} alert-dismissible fade show" role="alert">
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        `;
      }

      document.getElementById("registerForm").addEventListener("submit", async function (e) {
        e.preventDefault();

        const username = document.getElementById("username").value;
        const email = document.getElementById("email").value;
        const fullName = document.getElementById("fullName").value;
        const password = document.getElementById("password").value;
        const confirmPassword = document.getElementById("confirmPassword").value;

        // Validate password match
        if (password !== confirmPassword) {
          showAlert('danger', '<strong>L·ªói!</strong> Password kh√¥ng kh·ªõp!');
          return;
        }

        try {
          const response = await fetch(`${window.API_CONFIG.BASE_URL}/api/auth/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: 'include',
            body: JSON.stringify({
              username,
              email,
              fullName,
              password,
              confirmPassword,
            }),
          });

          const result = await response.json();

          if (result.success) {
            showAlert('success', '<strong>Th√†nh c√¥ng!</strong> ƒêƒÉng k√Ω th√†nh c√¥ng! ƒêang chuy·ªÉn ƒë·∫øn trang ƒëƒÉng nh·∫≠p...');
            setTimeout(() => {
              window.location.href = "login.html";
            }, 2000);
          } else {
            showAlert('danger', `<strong>L·ªói!</strong> ${result.message || 'ƒêƒÉng k√Ω th·∫•t b·∫°i'}`);
          }
        } catch (error) {
          console.error('Register error:', error);
          showAlert('danger', '<strong>L·ªói!</strong> Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. Vui l√≤ng th·ª≠ l·∫°i sau.');
        }
      });
    </script>
  </body>
</html>
